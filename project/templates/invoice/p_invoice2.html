<!DOCTYPE html>
{% load static %}
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ÙØ§ØªÙˆØ±Ø© Ù…Ø­ÙØ¸Ø© - {{ bill.id }}</title>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;600&display=swap" rel="stylesheet">
  
  <style>
    /* Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø£Ø³Ø§Ø³ÙŠØ© Ù„Ù„Ø·Ø¨Ø§Ø¹Ø© 57Ù…Ù… */
    :root {
      --primary-color: #000;
      --secondary-color: #333;
      --accent-color: #666;
      --border-color: #ccc;
      --light-bg: #f8f8f8;
      --highlight-bg: #f0f0f0;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-print-color-adjust: exact;
      print-color-adjust: exact;
    }
    
    body {
      font-family: 'Tajawal', sans-serif;
      width: 57mm;
      min-height: 100vh;
      margin: 0 auto;
      padding: 3mm 2mm;
      background: #fff;
      color: var(--primary-color);
      font-size: 9px;
      line-height: 1.25;
    }
    
    /* Ø­Ø§ÙˆÙŠØ© Ø§Ù„ÙØ§ØªÙˆØ±Ø© */
    .receipt {
      width: 100%;
      position: relative;
    }
    
    /* Ø±Ø£Ø³ Ø§Ù„ÙØ§ØªÙˆØ±Ø© */
    .header {
      text-align: center;
      padding-bottom: 6px;
      margin-bottom: 6px;
      border-bottom: 2px solid var(--primary-color);
      position: relative;
    }
    
    .store-name {
      font-size: 12px;
      font-weight: 700;
      margin-bottom: 3px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: var(--primary-color);
    }
    
    .company-info {
      font-size: 8px;
      color: var(--secondary-color);
      line-height: 1.1;
      margin-bottom: 2px;
    }
    
    .website {
      font-size: 8px;
      color: var(--secondary-color);
      direction: ltr;
      text-align: center;
    }
    
    /* Ø§Ù„Ø®Ø· Ø§Ù„ÙØ§ØµÙ„ Ø§Ù„Ù…Ù…ÙŠØ² */
    .divider {
      height: 1px;
      background: repeating-linear-gradient(
        to right,
        transparent,
        transparent 2px,
        var(--primary-color) 2px,
        var(--primary-color) 4px
      );
      margin: 5px 0;
    }
    
    /* Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ÙØ§ØªÙˆØ±Ø© */
    .invoice-info {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 4px;
      margin: 8px 0;
      padding: 6px;
      background: var(--light-bg);
      border-radius: 3px;
      border-right: 3px solid var(--accent-color);
    }
    
    .info-row {
      display: flex;
      justify-content: space-between;
    }
    
    .info-label {
      font-size: 8px;
      color: var(--secondary-color);
      font-weight: 500;
      min-width: 45px;
    }
    
    .info-value {
      font-size: 9px;
      font-weight: 600;
      color: var(--primary-color);
      text-align: left;
      direction: ltr;
    }
    
    /* Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ */
    .customer-section {
      background: var(--highlight-bg);
      padding: 6px;
      margin: 8px 0;
      border-radius: 3px;
      border: 1px solid var(--border-color);
    }
    
    .section-title {
      font-size: 9px;
      font-weight: 700;
      color: var(--primary-color);
      margin-bottom: 4px;
      padding-bottom: 2px;
      border-bottom: 1px dotted var(--border-color);
    }
    
    .customer-details {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 4px;
    }
    
    .customer-item {
      display: flex;
      justify-content: space-between;
    }
    
    .customer-label {
      font-size: 8px;
      color: var(--secondary-color);
    }
    
    .customer-data {
      font-size: 8px;
      font-weight: 500;
      color: var(--primary-color);
      text-align: left;
      max-width: 60%;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    
    /* Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…ÙØµÙ„ */
    .products-section {
      margin: 10px 0;
    }
    
    .products-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 8px;
      margin-bottom: 8px;
    }
    
    .products-table thead {
      background: var(--primary-color);
      color: white;
    }
    
    .products-table th {
      padding: 5px 3px;
      font-weight: 600;
      text-align: center;
      border: 1px solid var(--primary-color);
    }
    
    .products-table th:first-child {
      border-top-right-radius: 2px;
    }
    
    .products-table th:last-child {
      border-top-left-radius: 2px;
    }
    
    .products-table td {
      padding: 4px 3px;
      text-align: center;
      border: 1px solid var(--border-color);
      vertical-align: top;
    }
    
    .product-name {
      text-align: right;
      font-weight: 500;
      max-width: 35mm;
      word-break: break-word;
    }
    
    .product-details {
      font-size: 7px;
      color: var(--secondary-color);
      margin-top: 1px;
      line-height: 1.1;
    }
    
    .col-no { width: 8%; }
    .col-name { width: 45%; }
    .col-price { width: 12%; }
    .col-qty { width: 10%; }
    .col-total { width: 15%; }
    
    .price-cell {
      font-family: 'Tajawal', sans-serif;
      direction: ltr;
      font-weight: 500;
    }
    
    /* ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨ */
    .order-details {
      background: var(--light-bg);
      padding: 6px;
      margin: 8px 0;
      border-radius: 3px;
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 5px;
      border-top: 2px solid var(--accent-color);
    }
    
    .detail-item {
      display: flex;
      justify-content: space-between;
    }
    
    .detail-label {
      font-size: 8px;
      color: var(--secondary-color);
      font-weight: 500;
    }
    
    .detail-value {
      font-size: 8px;
      font-weight: 600;
      color: var(--primary-color);
      text-align: left;
      direction: ltr;
    }
    
    /* Ù‚Ø³Ù… Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª */
    .calculation-section {
      margin: 10px 0;
      padding: 8px;
      background: linear-gradient(to bottom, #fefefe, #f5f5f5);
      border-radius: 3px;
      border: 1px solid var(--border-color);
      position: relative;
    }
    
    .calculation-section::before {
      content: "Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª";
      position: absolute;
      top: -8px;
      right: 10px;
      background: white;
      padding: 0 5px;
      font-size: 8px;
      font-weight: 700;
      color: var(--accent-color);
    }
    
    .calc-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 4px;
      padding-bottom: 3px;
      border-bottom: 1px dotted var(--border-color);
    }
    
    .calc-row:last-child {
      border-bottom: none;
      margin-bottom: 0;
      padding-bottom: 0;
    }
    
    .calc-label {
      font-size: 9px;
      color: var(--secondary-color);
    }
    
    .calc-value {
      font-size: 9px;
      font-weight: 600;
      color: var(--primary-color);
      direction: ltr;
    }
    
    .calc-total {
      border-top: 2px solid var(--primary-color);
      padding-top: 5px;
      margin-top: 5px;
    }
    
    .calc-total .calc-label {
      font-size: 10px;
      font-weight: 700;
    }
    
    .calc-total .calc-value {
      font-size: 11px;
      font-weight: 700;
      color: var(--primary-color);
    }
    
    /* Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ© */
    .extra-info {
      margin: 10px 0;
      padding: 6px;
      background: var(--light-bg);
      border-radius: 3px;
      font-size: 8px;
      color: var(--secondary-color);
      line-height: 1.3;
      border-right: 2px solid var(--accent-color);
    }
    
    /* Ø§Ù„ØªÙˆÙ‚ÙŠØ¹Ø§Øª ÙˆØ§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª */
    .signatures {
      margin-top: 15px;
      padding-top: 8px;
      border-top: 2px dashed var(--border-color);
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
    }
    
    .signature-box {
      text-align: center;
    }
    
    .signature-line {
      height: 1px;
      background: var(--primary-color);
      margin: 15px 0 5px;
    }
    
    .signature-label {
      font-size: 8px;
      color: var(--secondary-color);
      margin-top: 2px;
    }
    
    /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… */
    .controls {
      margin-top: 20px;
      padding-top: 10px;
      border-top: 1px solid var(--border-color);
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    
    .btn {
      padding: 9px;
      border: none;
      border-radius: 3px;
      font-family: 'Tajawal', sans-serif;
      font-size: 9px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      text-align: center;
      text-decoration: none;
    }
    
    .btn-print {
      background: var(--primary-color);
      color: white;
    }
    
    .btn-print:hover {
      background: #222;
      transform: translateY(-1px);
    }
    
    .btn-back {
      background: var(--light-bg);
      color: var(--primary-color);
      border: 1px solid var(--border-color);
    }
    
    .btn-back:hover {
      background: #eee;
    }
    
    /* Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© */
    @media print {
      body {
        padding: 1mm;
        width: 57mm !important;
        font-size: 8px !important;
      }
      
      .controls {
        display: none !important;
      }
      
      @page {
        size: 57mm auto;
        margin: 0;
      }
      
      /* ØªØ­Ø³ÙŠÙ† Ø¯Ù‚Ø© Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø¹Ù†Ø¯ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© */
      .products-table th,
      .products-table td {
        padding: 3px 2px !important;
      }
      
      /* Ø¬Ø¹Ù„ Ø§Ù„Ø®Ù„ÙÙŠØ§Øª ØªØ¸Ù‡Ø± Ø¹Ù†Ø¯ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© */
      .products-table thead,
      .customer-section,
      .calculation-section {
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
      }
    }
    
    /* ØªØ®ØµÙŠØµØ§Øª Ù„Ù„Ø´Ø§Ø´Ø© */
    @media screen {
      body {
        box-shadow: 0 0 15px rgba(0,0,0,0.1);
        margin: 20px auto;
        min-height: auto;
      }
      
      .receipt {
        padding-bottom: 20px;
      }
    }
    
    /* Ø¹Ù„Ø§Ù…Ø© Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ø­Ù„ */
    .store-copy-badge {
      position: absolute;
      top: -8px;
      left: 10px;
      background: var(--primary-color);
      color: white;
      padding: 2px 6px;
      border-radius: 2px;
      font-size: 7px;
      font-weight: 600;
      transform: rotate(-90deg);
      transform-origin: left top;
    }
    
    /* Ø¹Ù…Ù„Ø© */
    .currency {
      font-family: 'Tajawal', sans-serif;
      font-size: 8px;
      margin: 0 1px;
    }
  </style>
</head>
<body>
  
  <!-- Ø¹Ù„Ø§Ù…Ø© Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ø­Ù„ -->
  <div class="store-copy-badge">Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ø­Ù„</div>
  
  <!-- Ø­Ø§ÙˆÙŠØ© Ø§Ù„ÙØ§ØªÙˆØ±Ø© -->
  <div class="receipt">
    
    <!-- Ø±Ø£Ø³ Ø§Ù„ÙØ§ØªÙˆØ±Ø© -->
    <div class="header">
      <div class="store-name">{{ bill.menu.customer.store_ar_name|default:"Ù…Ø·Ø¹Ù… Ø§Ù„Ù†Ø®Ø¨Ø©" }}</div>
      <div class="company-info">{{ bill.menu.customer.company_name|default:"Ø´Ø±ÙƒØ© Ø§Ù„Ù…Ø·Ø§Ø¹Ù… Ø§Ù„Ù…ØªØ·ÙˆØ±Ø©" }}</div>
      <div class="company-info">{{ bill.menu.customer.address|default:"Ø­ÙŠ Ø§Ù„ØµØ­Ø§ÙØ©ØŒ Ø´Ø§Ø±Ø¹ Ø§Ù„Ø¹Ø±ÙˆØ¨Ø©ØŒ Ø§Ù„Ø±ÙŠØ§Ø¶ 12345" }}</div>
      <div class="website">{{ bill.menu.customer.website|default:"www.elite-restaurant.com" }}</div>
    </div>
    
    <div class="divider"></div>
    
    <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ÙØ§ØªÙˆØ±Ø© -->
    <div class="invoice-info">
      <div class="info-row">
        <span class="info-label">Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø©:</span>
        <span class="info-value">#{{ bill.ordernumber|default:"2024-00157" }}</span>
      </div>
      <div class="info-row">
        <span class="info-label">Ø§Ù„ØªØ§Ø±ÙŠØ®:</span>
        <span class="info-value">{{ bill.created_at|date:"Y/m/d"|default:"2024/03/15" }}</span>
      </div>
      <div class="info-row">
        <span class="info-label">Ø§Ù„ÙˆÙ‚Øª:</span>
        <span class="info-value">{{ bill.created_at|time:"H:i"|default:"14:30" }}</span>
      </div>
      <div class="info-row">
        <span class="info-label">Ù†ÙˆØ¹ Ø§Ù„Ø·Ù„Ø¨:</span>
        <span class="info-value">{{ bill.order_type|default:"ØªÙˆØµÙŠÙ„" }}</span>
      </div>
      <div class="info-row">
        <span class="info-label">Ø±Ù‚Ù… Ø§Ù„Ø·Ø§ÙˆÙ„Ø©:</span>
        <span class="info-value">{{ bill.table_number|default:"--" }}</span>
      </div>
      <div class="info-row">
        <span class="info-label">Ø§Ù„Ù†Ø§Ø¯Ù„:</span>
        <span class="info-value">{{ bill.waiter|default:"Ø£Ø­Ù…Ø¯" }}</span>
      </div>
    </div>
    
    <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ -->
    <div class="customer-section">
      <div class="section-title">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„</div>
      <div class="customer-details">
        <div class="customer-item">
          <span class="customer-label">Ø§Ù„Ø§Ø³Ù…:</span>
          <span class="customer-data">{{ bill.customer_name|default:"Ù…Ø­Ù…Ø¯ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø£Ø­Ù…Ø¯" }}</span>
        </div>
        <div class="customer-item">
          <span class="customer-label">Ø§Ù„Ù‡Ø§ØªÙ:</span>
          <span class="customer-data">{{ bill.customer_phone|default:"0551234567" }}</span>
        </div>
        {% if bill.delivery_address %}
        <div class="customer-item" style="grid-column: 1 / -1;">
          <span class="customer-label">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØªÙˆØµÙŠÙ„:</span>
          <span class="customer-data">{{ bill.delivery_address.name|default:"Ø­ÙŠ Ø§Ù„Ø±Ø¨ÙŠØ¹ØŒ Ø´Ø§Ø±Ø¹ Ø§Ù„Ø®Ù„ÙŠØ¬ØŒ Ù…Ø¨Ù†Ù‰ 12ØŒ Ø´Ù‚Ø© 5" }}</span>
        </div>
        {% endif %}
        <div class="customer-item">
          <span class="customer-label">ÙˆÙ‚Øª Ø§Ù„ØªØ³Ù„ÙŠÙ…:</span>
          <span class="customer-data">{{ bill.delivery_time|default:"30-45 Ø¯Ù‚ÙŠÙ‚Ø©" }}</span>
        </div>
      </div>
    </div>
    
    <!-- Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª -->
    <div class="products-section">
      <table class="products-table">
        <thead>
          <tr>
            <th class="col-no">#</th>
            <th class="col-name">Ø§Ù„Ù…Ù†ØªØ¬</th>
            <th class="col-price">Ø§Ù„Ø³Ø¹Ø±</th>
            <th class="col-qty">Ø§Ù„ÙƒÙ…ÙŠØ©</th>
            <th class="col-total">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th>
          </tr>
        </thead>
        <tbody>
          {% for i in items %}
          <tr>
            <td>{{ forloop.counter }}</td>
            <td class="product-name">
              {{ i.product.name|default:"Ø´Ø§ÙˆØ±Ù…Ø§ Ù„Ø­Ù… Ø¯Ø¬Ø§Ø¬" }}
              <div class="product-details">
                {% if i.size %}Ù…Ù‚Ø§Ø³: {{ i.size }} | {% endif %}
                {% if i.color %}Ù„ÙˆÙ†: {{ i.color }} | {% endif %}
                {% if i.notes %}Ù…Ù„Ø§Ø­Ø¸Ø§Øª: {{ i.notes|truncatechars:15 }}{% endif %}
              </div>
            </td>
            <td class="price-cell">{{ i.product.price|default:"35" }} <span class="currency">Ø±.Ø³</span></td>
            <td>{{ i.quantity|default:"2" }}</td>
            <td class="price-cell">{{ i.get_final_price|default:"70" }} <span class="currency">Ø±.Ø³</span></td>
          </tr>
          {% endfor %}
          
          <!-- Ø¨ÙŠØ§Ù†Ø§Øª ÙˆÙ‡Ù…ÙŠØ© Ù„Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© -->
          <tr>
            <td>1</td>
            <td class="product-name">
              Ø´Ø§ÙˆØ±Ù…Ø§ Ù„Ø­Ù… Ù…ÙƒØ³ÙŠÙƒÙŠØ©
              <div class="product-details">Ù…Ù‚Ø§Ø³: ÙƒØ¨ÙŠØ± | Ø¥Ø¶Ø§ÙØ§Øª: ØµÙˆØµ Ø­Ø§Ø±</div>
            </td>
            <td class="price-cell">45 <span class="currency">Ø±.Ø³</span></td>
            <td>1</td>
            <td class="price-cell">45 <span class="currency">Ø±.Ø³</span></td>
          </tr>
          <tr>
            <td>2</td>
            <td class="product-name">
              Ø¨Ø±Ø¬Ø± Ù„Ø­Ù… Ø¨Ø§Ù„Ø¬Ø¨Ù†Ø©
              <div class="product-details">Ù…Ù‚Ø§Ø³: Ø¹Ø§Ø¦Ù„ÙŠ | Ø¨Ø¯ÙˆÙ† Ø¨ØµÙ„</div>
            </td>
            <td class="price-cell">32 <span class="currency">Ø±.Ø³</span></td>
            <td>2</td>
            <td class="price-cell">64 <span class="currency">Ø±.Ø³</span></td>
          </tr>
          <tr>
            <td>3</td>
            <td class="product-name">
              Ø¨ÙŠØªØ²Ø§ Ø®Ø¶Ø§Ø± ÙƒØ¨ÙŠØ±Ø©
              <div class="product-details">Ø­Ø¬Ù…: ÙƒØ¨ÙŠØ± | Ø¥Ø¶Ø§ÙØ§Øª: Ø¬Ø¨Ù† Ø¥Ø¶Ø§ÙÙŠ</div>
            </td>
            <td class="price-cell">55 <span class="currency">Ø±.Ø³</span></td>
            <td>1</td>
            <td class="price-cell">55 <span class="currency">Ø±.Ø³</span></td>
          </tr>
          <tr>
            <td>4</td>
            <td class="product-name">
              Ù…Ø´Ø±ÙˆØ¨ Ø·Ø§Ù‚Ø©
              <div class="product-details">Ù†ÙˆØ¹: Ø±ÙŠØ¯ Ø¨ÙˆÙ„</div>
            </td>
            <td class="price-cell">8 <span class="currency">Ø±.Ø³</span></td>
            <td>3</td>
            <td class="price-cell">24 <span class="currency">Ø±.Ø³</span></td>
          </tr>
        </tbody>
      </table>
    </div>
    
    <!-- ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨ -->
    <div class="order-details">
      <div class="detail-item">
        <span class="detail-label">Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹:</span>
        <span class="detail-value">{{ bill.payment_method|default:"Ù†Ù‚Ø¯Ø§Ù‹" }}</span>
      </div>
      <div class="detail-item">
        <span class="detail-label">Ø­Ø§Ù„Ø© Ø§Ù„Ø¯ÙØ¹:</span>
        <span class="detail-value" style="color: #27ae60;">{{ bill.payment_status|default:"Ù…Ø¯ÙÙˆØ¹" }}</span>
      </div>
      <div class="detail-item">
        <span class="detail-label">Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„ØªÙˆØµÙŠÙ„:</span>
        <span class="detail-value">{{ bill.delivery_method|default:"Ø³Ø§Ø¦Ù‚ Ø®Ø§Øµ" }}</span>
      </div>
      <div class="detail-item">
        <span class="detail-label">Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨:</span>
        <span class="detail-value">ORD-{{ bill.ordernumber|default:"157" }}</span>
      </div>
      {% if bill.notes %}
      <div class="detail-item" style="grid-column: 1 / -1;">
        <span class="detail-label">Ù…Ù„Ø§Ø­Ø¸Ø§Øª:</span>
        <span class="detail-value">{{ bill.notes|default:"Ø§Ù„ØªÙˆØµÙŠÙ„ Ù‚Ø¨Ù„ Ø§Ù„Ø³Ø§Ø¹Ø© 3 Ø¹ØµØ±Ø§Ù‹" }}</span>
      </div>
      {% endif %}
    </div>
    
    <!-- Ù‚Ø³Ù… Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª -->
    <div class="calculation-section">
      <div class="calc-row">
        <span class="calc-label">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø¬Ø²Ø¦ÙŠ:</span>
        <span class="calc-value">188 <span class="currency">Ø±.Ø³</span></span>
      </div>
      <div class="calc-row">
        <span class="calc-label">Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¶Ø§ÙØ© (15%):</span>
        <span class="calc-value">28.2 <span class="currency">Ø±.Ø³</span></span>
      </div>
      <div class="calc-row">
        <span class="calc-label">Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„:</span>
        <span class="calc-value">15 <span class="currency">Ø±.Ø³</span></span>
      </div>
      <div class="calc-row">
        <span class="calc-label">Ø®ØµÙ… Ø§Ù„ÙˆÙ„Ø§Ø¡ (5%):</span>
        <span class="calc-value">-9.4 <span class="currency">Ø±.Ø³</span></span>
      </div>
      <div class="calc-row calc-total">
        <span class="calc-label">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ:</span>
        <span class="calc-value">221.8 <span class="currency">Ø±.Ø³</span></span>
      </div>
    </div>
    
    <!-- Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ© -->
    <div class="extra-info">
      <strong>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©:</strong><br>
      â€¢ ÙˆÙ‚Øª Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙØ§ØªÙˆØ±Ø©: {{ bill.created_at|time:"H:i:s"|default:"14:30:15" }}<br>
      â€¢ ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø¨ÙˆØ§Ø³Ø·Ø©: {{ bill.created_by|default:"Ø§Ù„Ù†Ø¸Ø§Ù…" }}<br>
      â€¢ Ù…Ø±Ø¬Ø¹ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø©: TXN-{{ bill.ordernumber|default:"157" }}-{{ bill.created_at|date:"Ymd"|default:"20240315" }}
    </div>
    
    <!-- Ø§Ù„ØªÙˆÙ‚ÙŠØ¹Ø§Øª -->
    <div class="signatures">
      <div class="signature-box">
        <div class="signature-line"></div>
        <div class="signature-label">ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ù†Ø§Ø¯Ù„</div>
      </div>
      <div class="signature-box">
        <div class="signature-line"></div>
        <div class="signature-label">ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ø¹Ù…ÙŠÙ„</div>
      </div>
    </div>
    
  </div>
  
  <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… -->
  <div class="controls">
    <button class="btn btn-print" onclick="printReceipt()">
      ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ø­Ù„
    </button>
    <a href="{% url 'customer_dashboard' %}" class="btn btn-back">
      â† Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
    </a>
  </div>

  <script>
    // Ø¯Ø§Ù„Ø© Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ù…Ø®ØµØµØ© Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ø­Ù„
    function printReceipt() {
      const printBtn = document.querySelector('.btn-print');
      const originalText = printBtn.innerHTML;
      
      // ØªØºÙŠÙŠØ± Ø­Ø§Ù„Ø© Ø§Ù„Ø²Ø±
      printBtn.innerHTML = 'â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ø¶ÙŠØ± Ù„Ù„Ø·Ø¨Ø§Ø¹Ø©...';
      printBtn.disabled = true;
      printBtn.style.opacity = '0.7';
      
      // Ø¥Ø¶Ø§ÙØ© Ø¨Ø§Ø±ÙƒÙˆØ¯ Ù‚Ø¨Ù„ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
      addBarcodeIfNeeded();
      
      // ØªØ£Ø®ÙŠØ± Ø«Ù… Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©
      setTimeout(() => {
        window.print();
        
        // Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø­Ø§Ù„Ø© Ø§Ù„Ø²Ø± Ø¨Ø¹Ø¯ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©
        setTimeout(() => {
          printBtn.innerHTML = originalText;
          printBtn.disabled = false;
          printBtn.style.opacity = '1';
        }, 1000);
      }, 500);
    }
    
    // Ø¥Ø¶Ø§ÙØ© Ø¨Ø§Ø±ÙƒÙˆØ¯ Ù„Ù„ÙØ§ØªÙˆØ±Ø©
    function addBarcodeIfNeeded() {
      if (!document.querySelector('.barcode')) {
        const barcodeContainer = document.createElement('div');
        barcodeContainer.className = 'barcode';
        barcodeContainer.style.cssText = `
          text-align: center;
          margin: 10px 0;
          padding: 5px;
          background: white;
          font-family: monospace;
          letter-spacing: 2px;
          font-size: 10px;
          border-top: 1px solid #ddd;
          border-bottom: 1px solid #ddd;
        `;
        
        // Ø¨Ø§Ø±ÙƒÙˆØ¯ Ù†ØµÙŠ Ø¨Ø³ÙŠØ·
        const barcodeText = `*${bill.ordernumber || '2024-00157'}*`;
        barcodeContainer.textContent = barcodeText;
        
        // Ø¥Ø¶Ø§ÙØ© Ù‚Ø¨Ù„ Ø§Ù„ØªÙˆÙ‚ÙŠØ¹Ø§Øª
        const signatures = document.querySelector('.signatures');
        if (signatures) {
          signatures.parentNode.insertBefore(barcodeContainer, signatures);
        }
      }
    }
    
    // Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ© Ø¥Ø°Ø§ ÙƒØ§Ù† ÙÙŠ Ø±Ø§Ø¨Ø·
    document.addEventListener('DOMContentLoaded', function() {
      const urlParams = new URLSearchParams(window.location.search);
      if (urlParams.has('print')) {
        setTimeout(() => {
          printReceipt();
        }, 800);
      }
      
      // Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ±Ø§Øª ØªÙØ§Ø¹Ù„ÙŠØ©
      const rows = document.querySelectorAll('.products-table tbody tr');
      rows.forEach(row => {
        row.addEventListener('mouseenter', function() {
          this.style.backgroundColor = '#f9f9f9';
        });
        
        row.addEventListener('mouseleave', function() {
          this.style.backgroundColor = '';
        });
      });
    });
  </script>
</body>
</html>