<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>{{bill.id}}-{{bill.ordernumber}}  - ÙØ§ØªÙˆØ±</title>

<style>
@page {
    size: A4;
    margin: 5mm;
}

@media print {
    body {
        margin: 0;
        padding: 0;
        font-size: 10pt;
        background: #fff;
    }
    .no-print {
        display: none !important;
    }
    .invoice {
        page-break-inside: avoid;
        page-break-after: avoid;
    }
}

* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
    font-family: Tahoma, Arial, sans-serif;
}

body {
    background: #eee;
    padding: 10px;
}

.invoice {
    width: 100%;
    max-width: 210mm;
    min-height: auto;
    max-height: 280mm; 
    background: #fff;
    padding: 8mm;
    color: #000;
    position: relative;
    border: 2px solid #000;
    margin: 0 auto;
}

.watermark {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) rotate(-30deg);
    font-size: 60pt;
    color: rgba(0,0,0,0.04);
    font-weight: bold;
    pointer-events: none;
    white-space: nowrap;
    z-index: 1;
}

.header {
    text-align: center;
    border-bottom: 2px double #000;
    padding-bottom: 6px;
    margin-bottom: 12px;
    position: relative;
    z-index: 3;
}

.header h1 {
    font-size: 18pt;
    margin-bottom: 4px;
}

.invoice-number {
    font-size: 11pt;
    background: #000;
    color: #fff;
    display: inline-block;
    padding: 2px 12px;
    border-radius: 3px;
    margin: 3px 0;
    font-weight: bold;
}

.date-time {
    font-size: 10pt;
}

.info-section {
    display: flex;
    gap: 12px;
    margin-bottom: 12px;
    position: relative;
    z-index: 3;
}

.info-box {
    flex: 1;
    padding: 8px;
    border: 1px solid #ccc;
    background: #f9f9f9;
    font-size: 9pt;
}

.info-title {
    font-size: 11pt;
    font-weight: bold;
    margin-bottom: 4px;
    border-right: 2px solid #000;
    padding-right: 5px;
}

.info-content {
    font-size: 9pt;
    line-height: 1.4;
}

table {
    width: 100%;
    border-collapse: collapse;
    margin: 12px 0;
    border: 1px solid #000;
    position: relative;
    z-index: 3;
}

thead {
    background: #000;
    color: #fff;
}

th, td {
    border: 1px solid #ccc;
    padding: 6px 4px;
    font-size: 9pt;
    text-align: center;
}

.desc {
    text-align: right;
    width: 45%;
}

.totals {
    width: 35%;
    margin-left: auto;
    margin-top: 12px;
    font-size: 10pt;
    position: relative;
    z-index: 3;
}

.total-row {
    display: flex;
    justify-content: space-between;
    padding: 4px 0;
    border-bottom: 1px dashed #999;
}

.grand-total {
    font-size: 12pt;
    font-weight: bold;
    border-top: 2px solid #000;
    border-bottom: 2px solid #000;
    padding: 6px 0;
    margin-top: 5px;
}

.payment-method {
    margin: 12px 0;
    padding: 8px;
    border: 1px solid #000;
    background: #f5f5f5;
    text-align: center;
    font-size: 11pt;
    font-weight: bold;
    position: relative;
    z-index: 3;
}

.footer {
    margin-top: 15px;
    padding-top: 8px;
    border-top: 1px dashed #000;
    font-size: 8pt;
    position: relative;
    z-index: 3;
}

.footer-contacts {
    display: flex;
    justify-content: space-between;
    margin-top: 8px;
    background: #f9f9f9;
    padding: 5px;
    font-size: 8pt;
}

.footer-contacts div {
    flex: 1;
    text-align: center;
}

.controls {
    position: fixed;
    top: 15px;
    left: 50%;
    transform: translateX(-50%);
    background: #fff;
    padding: 8px 15px;
    border: 2px solid #000;
    z-index: 1000;
    border-radius: 4px;
}

.controls button {
    padding: 6px 12px;
    background: #000;
    color: #fff;
    border: none;
    cursor: pointer;
    border-radius: 3px;
    font-size: 10pt;
}

.controls button:hover {
    background: #333;
}
</style>
</head>

<body>

<div class="controls no-print">
    <button onclick="window.print()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ÙØ§ØªÙˆØ±Ø©</button>
    <a href="{% url 'customer_dashboard' %}" class="back-btn">â† Ø§Ù„Ø¹ÙˆØ¯Ø©  </a>

</div>

<div class="invoice">
    <div class="watermark">{{ bill.menu.customer.store_ar_name }}</div>

    <div class="header">
        <h1>{{ bill.menu.customer.store_ar_name }}</h1>
        <div class="invoice-number">ÙØ§ØªÙˆØ±Ø© Ø±Ù‚Ù… #{{bill.ordernumber}}-{{bill.id}}</div>
        <div class="date-time">ØªØ§Ø±ÙŠØ®:{{ bill.created_at|date:"Y/m/d " }}</div>
    </div>

    <div class="info-section">
        <div class="info-box">
            <div class="info-title">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„</div>
            <div class="info-content">
                {{ bill.customer_name}}
                 Ù‡Ø§ØªÙ: {{ bill.customer_phone }}<br>
                {% if bill.delivery_address %}
                   Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…: ØªÙˆØµÙŠÙ„ <br>

                  Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: {{ bill.delivery_address.name }}<br>
                {% elif bill.company_delivery_city %}
                   Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…: ØªÙˆØµÙŠÙ„ <br>

                  Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: {{ bill.company_delivery_city }}<br>                
                {% else %}
                  Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…: Ø§Ø³ØªÙ„Ø§Ù… Ù…Ù† Ø§Ù„Ù…Ø­Ù„<br>
                {% endif %}
                {% if bill.order_type %}
                 Ù†ÙˆØ¹ Ø§Ù„Ø·Ù„Ø¨: {{ bill.order_type }}<br>
                {% endif %}  
            </div>
        </div>
        <div class="info-box">
            <div class="info-title">Ø¨ÙŠØ§Ù†Ø§ØªÙ†Ø§</div>
            <div class="info-content">
              {{ bill.menu.customer.store_ar_name }}<br>
                Ù‡Ø§ØªÙ:{{ bill.menu.customer.phone }}<br>
            </div>
        </div>
    </div>

    <table>
        <thead>
            <tr>
                <th>#</th>
                <th class="desc">Ø§Ù„ÙˆØµÙ</th>
                <th>Ø§Ù„ÙƒÙ…ÙŠØ©</th>
                <th>Ø§Ù„Ø³Ø¹Ø±</th>
                <th>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th>
            </tr>
        </thead>
        <tbody>
            {% for i in items %}

            <tr>
                <td>{{ forloop.counter }}</td>
                <td class="desc">{{ i.product.name }}{% if i.size %}{{ i.size }}Ø§Ù„Ù…Ù‚Ø§Ø³:{% endif %}{% if i.color %}Ø§Ù„Ù„ÙˆÙ†:{{ i.color }}{% endif %}</td>
                <td>{{ i.quantity }}</td>
                <td>{{ i.product.price }} Ø¯.Ù„</td>
                <td>{{ i.get_final_price }} Ø¯.Ù„</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <div class="totals">
        {% if bill.notes %}
        <div class="total-row"><span>Ù…Ù„Ø§Ø­Ø¸Ø§Øª:</span><span>{{bill.notes}}</span></div>
        {% endif %}
        {% if bill.delivery_address %}
        <div class="total-row"><span>Ø§Ù„ØªÙˆØµÙŠÙ„</span><span>{{ bill.delivery_address.price  }}</span></div>
        {% elif bill.company_delivery_city %}
        <div class="total-row"><span>Ø§Ù„ØªÙˆØµÙŠÙ„</span><span>{{ bill.company_delivery_price  }}</span></div>
        
        {% endif %}
        
        
        <div class="grand-total"><span>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</span>{{ bill.get_total }} Ø¯.Ù„</div>
    </div>

    <div class="payment-method">Ø´ÙƒØ±Ø§ Ù„ØªØ¹Ø§Ù…Ù„ÙƒÙ… Ù…Ø¹Ù†Ø§</div>

    <div class="footer">
        <div class="footer-contacts">
            <div>ğŸ“ {{bill.menu.customer.phone}} </div>
            <div>ğŸŒ https://liysta.ly/{{bill.menu.customer.store_slug}}</div>
            <div>ğŸ“ Ù„ÙŠØ¨ÙŠØ§</div>
        </div>
    </div>
</div>

</body>
</html>